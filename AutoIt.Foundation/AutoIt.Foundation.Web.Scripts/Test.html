<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css"  href="Scripts/codemirror-2.37/lib/codemirror.css"/>
    <script type="text/javascript" src="Scripts/jquery-1.11.3.js"></script>
    <script type="text/javascript" src="Scripts/jquery.linq.js"></script>
    <script type="text/javascript" src="Scripts/codemirror-2.37/lib/codemirror.js"></script>
    <script type="text/javascript" src="AutoIt.js"></script>
</head>
<body>
<textarea id="code"></textarea>

<script type="text/javascript">
    var code = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");

    function base64ToBin(str) {
        var bitString = "";
        var tail = 0;
        for (var i = 0; i < str.length; i++) {
            if (str[i] != "=") {
                var decode = code.indexOf(str[i]).toString(2);
                bitString += (new Array(7 - decode.length)).join("0") + decode;
            } else {
                tail++;
            }
        }
        return bitString.substr(0, bitString.length - tail * 2);
    }


    CodeMirror.defineMIME("text/xml", "xml");

    var editor =CodeMirror.fromTextArea(document.getElementById("code"),
   {
       mode: 'text/xml',
       lineNumbers: true
       //theme: 'seti'
   });

    $.get("data/xml.egt.base64",
        function(data) {
            data = base64ToBin(data);
            // console.log(data)
            //  var egtManager = new CodeEdit.LangAnaly.EgtManager.CreateFromStr(data);
            //console.log(egtManager);
            //return;

            var fun = function() {
                /*<root a="1" b="2">
                  <page width="400px" height="500px"> 
                   jj, kll, </page>
                </root>*/
            }
            fun = function() {
                /*<a b="3">kkkk;'5@!!"s"</a>*/
            }
            var myregexp = /\/\*([\w\W]+)\*\//img;
            var xml = myregexp.exec(fun.toString())[1];
            console.log(xml);

            var manager = new CodeEdit.LangAnaly.Lang.PrintLangManager(data);
            manager.ContentNameGroup = $.Enumerable.From(["Word", "Text", "Content"]).ToList();
            manager.PrintToken = true;
            manager.Analy(xml);
        });
</script>
</body>
</html>
